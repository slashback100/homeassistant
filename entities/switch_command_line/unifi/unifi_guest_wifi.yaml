 - switch:
     name: guest_wifi
     command_on: >-
           cookie=$(wget -S -qO- -T 5 --no-check-certificate --post-data='{"username":"christ", "password": "hirwyx-0jompy-rujWiz"}' 'https://192.168.0.211:8443/api/login' 2>&1 | grep Set-Cookie | cut -f2 -d':' | cut -f1 -d';' | xargs echo | sed -E 's/ /;/') && curl 'https://192.168.0.211:8443/api/s/default/rest/wlanconf/60be722bc0e3eb5a16dfda75' -X 'PUT' -H 'Content-Type: application/json;charset=utf-8' -H 'Accept: application/json, text/plain, */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-gb' -H 'Host: 192.168.0.211:8443' -H 'Origin: https://192.168.0.211:8443' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15' -H 'Connection: keep-alive' -H 'Referer: https://192.168.0.211:8443/manage/default/settings/wifi/hotspot/form/60be722bc0e3eb5a16dfda75' -H 'Content-Length: 1355' -H 'Cookie: '"$cookie" -H 'X-Csrf-Token: j5DeCjXE218hMA6hPe5hjJg9xJJ7sMYP' --data-binary '{"ap_group_ids":["60be703dc0e3eb5a16dfda2c"],"enabled":true,"fast_roaming_enabled":false,"hide_ssid":false,"name":"wifi_network_guest","networkconf_id":"60be703dc0e3eb5a16dfda22","pmf_mode":"disabled","radiusprofile_id":"","usergroup_id":"60be703dc0e3eb5a16dfda23","wlan_bands":["2g","5g"],"wpa3_support":false,"wpa3_transition":false,"wpa3_fast_roaming":false,"wpa3_enhanced_192":false,"uapsd_enabled":false,"mcastenhance_enabled":false,"no2ghz_oui":false,"bss_transition":true,"proxy_arp":false,"l2_isolation":false,"b_supported":false,"optimize_iot_wifi_connectivity":true,"dtim_mode":"default","minrate_ng_enabled":true,"minrate_ng_data_rate_kbps":6000,"minrate_ng_advertising_rates":false,"minrate_na_enabled":false,"minrate_na_data_rate_kbps":6000,"minrate_na_advertising_rates":false,"mac_filter_enabled":false,"mac_filter_policy":"allow","mac_filter_list":[],"radius_mac_auth_enabled":false,"radius_macacl_format":"none_lower","_id":"60be722bc0e3eb5a16dfda75","bc_filter_enabled":false,"bc_filter_list":[],"iapp_enabled":true,"is_guest":true,"radius_das_enabled":false,"radius_macacl_empty_password":false,"schedule":[],"schedule_enabled":false,"security":"open","x_iapp_key":"9c78d4a83ca222336fa8800ae5cd0125","minrate_ng_mgmt_rate_kbps":6000,"minrate_ng_beacon_rate_kbps":6000,"minrate_na_mgmt_rate_kbps":6000,"minrate_na_beacon_rate_kbps":6000}' --insecure && wget -T 5 -S -qO- --no-check-certificate --header="Cookie: $cookie" --post-data='{}' 'https://192.168.0.211:8443/api/logout'
     command_off: >-
           cookie=$(wget -S -qO- -T 5 --no-check-certificate --post-data='{"username":"christ", "password": "hirwyx-0jompy-rujWiz"}' 'https://192.168.0.211:8443/api/login' 2>&1 | grep Set-Cookie | cut -f2 -d':' | cut -f1 -d';' | xargs echo | sed -E 's/ /;/') && curl -X PUT --insecure -d '{"name":"wifi_network_guest","ap_group_ids":["60be703dc0e3eb5a16dfda2c"],"enabled":false,"mcastenhance_enabled":false,"b_supported":false,"fast_roaming_enabled":false,"group_rekey":3600,"vlan_enabled":false,"vlan":3000,"hide_ssid":false,"x_wep":"","wep_idx":1,"radiusprofile_id":"","security":"open","schedule":[],"schedule_enabled":false,"wlan_band":"both","wpa_mode":"wpa2","is_guest":true,"uapsd_enabled":false,"no2ghz_oui":false,"minrate_ng_enabled":true,"minrate_ng_data_rate_kbps":6000,"minrate_ng_advertising_rates":false,"minrate_ng_cck_rates_enabled":true,"minrate_ng_beacon_rate_kbps":6000,"minrate_ng_mgmt_rate_kbps":1000,"minrate_na_enabled":false,"minrate_na_data_rate_kbps":6000,"minrate_na_advertising_rates":false,"minrate_na_mgmt_rate_kbps":6000,"dtim_mode":"default","dtim_na":3,"dtim_ng":3,"mac_filter_enabled":false,"mac_filter_policy":"allow","mac_filter_list":[],"radius_mac_auth_enabled":false,"radius_macacl_format":"none_lower","radius_macacl_empty_password":false,"bc_filter_enabled":false,"bc_filter_list":[],"radius_das_enabled":false,"_id":"60be722bc0e3eb5a16dfda75","usergroup_id":"60be703dc0e3eb5a16dfda23","networkconf_id":"60be703dc0e3eb5a16dfda22","iapp_enabled":true,"x_iapp_key":"9c78d4a83ca222336fa8800ae5cd0125"}'  -H "Cookie: $cookie"  'https://192.168.0.211:8443/api/s/default/rest/wlanconf/60be722bc0e3eb5a16dfda75' && wget -T 5 -S -qO- --no-check-certificate --header="Cookie: $cookie" --post-data='{}' 'https://192.168.0.211:8443/api/logout'
     command_state: >-
           cookie=$(wget -S -qO- -T 5 --no-check-certificate --post-data='{"username":"christ", "password": "hirwyx-0jompy-rujWiz"}' 'https://192.168.0.211:8443/api/login' 2>&1 | grep Set-Cookie | cut -f2 -d':' | cut -f1 -d';' | xargs echo | sed -E 's/ /;/') && wget -T 5 --no-check-certificate -S -qO-  --header="Cookie: $cookie" 'https://192.168.0.211:8443/api/s/default/rest/wlanconf/60be722bc0e3eb5a16dfda75' 2> /dev/null| jq '.data[0].enabled' && wget -T 5 -S -qO- --no-check-certificate --header="Cookie: $cookie" --post-data='{}' 'https://192.168.0.211:8443/api/logout' > /dev/null 2>&1
     value_template: '{{ value == "true" }}'
